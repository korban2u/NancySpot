<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nancy Spot - Carte de la ville</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- CSS personnalisé -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- Conteneur principal de l'application -->
<div id="app"></div>

<!-- ================================= -->
<!-- TEMPLATES HANDLEBARS PRINCIPAUX  -->
<!-- ================================= -->

<!-- Template Layout Principal -->
<script id="layout-template" type="text/x-handlebars-template">
    <!-- Header -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
        <div class="container-fluid">
            <div class="navbar-brand d-flex align-items-center">
                <i class="bi bi-geo-alt-fill text-primary me-2 fs-4"></i>
                <h1 class="mb-0 h4 text-primary">Nancy Spot</h1>
            </div>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <button class="nav-link btn btn-link {{#if (eq activeTab 'carte')}}active{{/if}}" data-tab="carte">
                            <i class="bi bi-map me-1"></i>Carte
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link btn btn-link {{#if (eq activeTab 'compte-rendu')}}active{{/if}}" data-tab="compte-rendu">
                            <i class="bi bi-file-text me-1"></i>Compte-rendu
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Contrôles carte -->
    <div class="bg-light border-bottom py-2 {{#unless (eq activeTab 'carte')}}d-none{{/unless}}" id="map-controls">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="btn-group" role="group">
                        <input type="checkbox" class="btn-check" id="filter-restaurants" data-type="restaurants" {{#if filters.restaurants}}checked{{/if}}>
                        <label class="btn btn-outline-primary" for="filter-restaurants">
                            <i class="bi bi-shop me-1"></i><span class="d-none d-md-inline">Restaurants</span>
                        </label>

                        <input type="checkbox" class="btn-check" id="filter-velib" data-type="velib" {{#if filters.velib}}checked{{/if}}>
                        <label class="btn btn-outline-success" for="filter-velib">
                            <i class="bi bi-bicycle me-1"></i><span class="d-none d-md-inline">Vélib</span>
                        </label>

                        <input type="checkbox" class="btn-check" id="filter-incidents" data-type="incidents" {{#if filters.incidents}}checked{{/if}}>
                        <label class="btn btn-outline-warning" for="filter-incidents">
                            <i class="bi bi-exclamation-triangle me-1"></i><span class="d-none d-md-inline">Incidents</span>
                        </label>
                    </div>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-success" id="refresh-button">
                        <i class="bi bi-arrow-clockwise me-1"></i><span class="d-none d-md-inline">Actualiser</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenu -->
    <main class="flex-fill position-relative">
        {{{carteContent}}}
        {{{compteRenduContent}}}
    </main>

    <!-- Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="toast" class="toast" role="alert">
            <div class="toast-header">
                <i id="toast-icon" class="bi me-2"></i>
                <strong class="me-auto">Nancy Spot</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body" id="toast-message"></div>
        </div>
    </div>
</script>

<!-- Template Carte -->
<script id="carte-template" type="text/x-handlebars-template">
    <div class="position-relative h-100">
        <div id="map" style="height: calc(100vh - 140px);"></div>

        {{#if loading}}
        <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-white bg-opacity-75" style="z-index: 1000;">
            <div class="text-center">
                <div class="spinner-border text-primary mb-3" role="status"></div>
                <p class="text-muted">Chargement...</p>
            </div>
        </div>
        {{/if}}

        <!-- Stats -->
        <div class="position-absolute bottom-0 start-0 m-3" style="z-index: 400;">
            <div class="card">
                <div class="card-body p-2">
                    <div class="d-flex gap-3 small">
                        <span><i class="bi bi-shop text-primary"></i> 0</span>
                        <span><i class="bi bi-bicycle text-success"></i> 0</span>
                        <span><i class="bi bi-exclamation-triangle text-warning"></i> 0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<!-- ================================= -->
<!-- TEMPLATES RESTAURANTS ET RÉSERVATION -->
<!-- ================================= -->

<!-- Template Popup Restaurant Amélioré -->
<script id="restaurant-popup-creneaux-template" type="text/x-handlebars-template">
    <div class="p-3">
        <h6 class="fw-bold mb-2">{{nom}}</h6>
        <div class="mb-3">
            <p class="mb-1 small"><i class="bi bi-geo-alt text-muted me-1"></i>{{adresse}}</p>
            <p class="mb-0 small"><i class="bi bi-telephone text-muted me-1"></i>{{telephone}}</p>
        </div>

        <!-- Indicateur de créneaux disponibles -->
        <div class="mb-3">
            <small class="text-muted d-block mb-2">Créneaux disponibles:</small>
            <div class="d-flex flex-wrap gap-1">
                <span class="badge bg-primary">Déjeuner</span>
                <span class="badge bg-primary">Dîner</span>
                <span class="badge bg-secondary">Brunch</span>
            </div>
        </div>

        <button class="btn btn-primary w-100 reserve-btn"
                data-restaurant-id="{{id}}"
                data-restaurant-name="{{nom}}">
            <i class="bi bi-calendar-plus me-1"></i>Réserver une table
        </button>
    </div>
</script>

<!-- Template principal de réservation avec sélection de créneaux -->
<script id="reservation-form-creneaux-template" type="text/x-handlebars-template">
    <div class="modal fade show" style="display: block;" id="reservation-modal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-calendar-plus me-2"></i>Réservation - {{restaurantName}}
                    </h5>
                    <button type="button" class="btn-close btn-close-white" id="close-reservation"></button>
                </div>

                <div class="modal-body">
                    <!-- Étape 1: Sélection de la date -->
                    <div class="step-container" id="step-date" style="display: block;">
                        <h6 class="fw-bold mb-3">
                            <span class="badge bg-primary me-2">1</span>Choisissez une date
                        </h6>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="dateReservation" class="form-label">Date de réservation</label>
                                <input type="date" class="form-control form-control-lg"
                                       id="dateReservation" name="dateReservation" required>
                            </div>
                            <div class="col-md-6 d-flex align-items-end">
                                <button type="button" class="btn btn-primary w-100" id="btn-next-date">
                                    Voir les créneaux disponibles
                                    <i class="bi bi-arrow-right ms-2"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Étape 2: Sélection du créneau -->
                    <div class="step-container" id="step-creneau" style="display: none;">
                        <h6 class="fw-bold mb-3">
                            <span class="badge bg-primary me-2">2</span>Choisissez un créneau horaire
                        </h6>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <small class="text-muted">Date sélectionnée:</small>
                                <span class="fw-bold" id="selected-date-display"></span>
                            </div>
                            <button type="button" class="btn btn-outline-secondary btn-sm" id="btn-back-date">
                                <i class="bi bi-arrow-left me-1"></i>Changer la date
                            </button>
                        </div>

                        <div id="creneaux-container">
                            <!-- Les créneaux seront injectés ici -->
                        </div>

                        <div class="text-center mt-3" id="loading-creneaux" style="display: none;">
                            <div class="spinner-border spinner-border-sm text-primary me-2"></div>
                            Chargement des créneaux...
                        </div>
                    </div>

                    <!-- Étape 3: Sélection de la table et informations client -->
                    <div class="step-container" id="step-table" style="display: none;">
                        <h6 class="fw-bold mb-3">
                            <span class="badge bg-primary me-2">3</span>Sélectionnez votre table et vos informations
                        </h6>

                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <small class="text-muted">Créneau sélectionné:</small>
                                <span class="fw-bold" id="selected-creneau-display"></span>
                            </div>
                            <button type="button" class="btn btn-outline-secondary btn-sm" id="btn-back-creneau">
                                <i class="bi bi-arrow-left me-1"></i>Changer le créneau
                            </button>
                        </div>

                        <form id="reservation-form" data-restaurant-id="{{restaurantId}}">
                            <input type="hidden" id="selectedCreneauId" name="creneauId">
                            <input type="hidden" id="selectedDate" name="dateReservation">

                            <!-- Sélection de la table -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Table disponible</label>
                                <div id="tables-container">
                                    <!-- Les tables seront injectées ici -->
                                </div>
                                <div class="text-center mt-3" id="loading-tables" style="display: none;">
                                    <div class="spinner-border spinner-border-sm text-primary me-2"></div>
                                    Chargement des tables...
                                </div>
                            </div>

                            <!-- Informations client -->
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="prenomClient" class="form-label">Prénom *</label>
                                    <input type="text" class="form-control" id="prenomClient" name="prenomClient" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="nomClient" class="form-label">Nom *</label>
                                    <input type="text" class="form-control" id="nomClient" name="nomClient" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="telephone" class="form-label">Téléphone *</label>
                                    <input type="tel" class="form-control" id="telephone" name="telephone"
                                           pattern="[0-9]{10}" placeholder="0612345678" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="nbConvives" class="form-label">Nombre de personnes *</label>
                                    <input type="number" class="form-control" id="nbConvives" name="nbConvives"
                                           min="1" max="20" value="2" required>
                                    <div class="form-text" id="capacite-info">
                                        <small class="text-muted">
                                            <i class="bi bi-info-circle me-1"></i>
                                            Capacité de la table sélectionnée: <span id="table-capacity">-</span> personnes
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Footer avec boutons d'action -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancel-reservation">
                        <i class="bi bi-x-circle me-1"></i>Annuler
                    </button>
                    <button type="submit" form="reservation-form" class="btn btn-success" id="confirm-reservation" disabled>
                        <i class="bi bi-check-lg me-1"></i>Confirmer la réservation
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade show"></div>
</script>

<!-- Template pour les créneaux disponibles -->
<script id="creneaux-disponibles-template" type="text/x-handlebars-template">
    {{#if creneaux.length}}
    <div class="row g-3">
        {{#each creneaux}}
        <div class="col-md-6">
            <div class="card creneau-card h-100" data-creneau-id="{{id}}" style="cursor: pointer;">
                <div class="card-body text-center">
                    <h6 class="card-title text-primary">{{libelle}}</h6>
                    <p class="card-text">
                        <i class="bi bi-clock text-muted me-1"></i>
                        <span class="fw-bold">{{heureDebut}} - {{heureFin}}</span>
                    </p>
                    <small class="text-muted">Cliquez pour sélectionner</small>
                </div>
            </div>
        </div>
        {{/each}}
    </div>
    {{else}}
    <div class="alert alert-warning text-center">
        <i class="bi bi-exclamation-triangle me-2"></i>
        Aucun créneau disponible pour cette date
    </div>
    {{/if}}
</script>

<!-- Template pour les tables avec statut -->
<script id="tables-avec-statut-template" type="text/x-handlebars-template">
    {{#if tables.length}}
    <div class="row g-2">
        {{#each tables}}
        <div class="col-6 col-md-4 col-lg-3">
            <div class="card table-card h-100 {{#unless disponible}}table-occupee{{/unless}}"
                 data-table-id="{{id}}"
                 {{#if disponible}}data-selectable="true" style="cursor: pointer;"{{/if}}>
            <div class="card-body text-center p-2">
                <div class="d-flex justify-content-between align-items-center mb-1">
                    <span class="fw-bold">Table {{numeroTable}}</span>
                    {{#if disponible}}
                    <i class="bi bi-check-circle text-success"></i>
                    {{else}}
                    <i class="bi bi-x-circle text-danger"></i>
                    {{/if}}
                </div>
                <small class="text-muted">
                    <i class="bi bi-people me-1"></i>{{nbPlaces}} places
                </small>
                <div class="mt-2">
                    {{#if disponible}}
                    <span class="badge bg-success">Disponible</span>
                    {{else}}
                    <span class="badge bg-danger">Occupée</span>
                    {{/if}}
                </div>
            </div>
        </div>
    </div>
    {{/each}}
    </div>
    <input type="hidden" id="tableId" name="tableId" required>
    <div class="mt-3">
        <small class="text-muted">
            <i class="bi bi-info-circle me-1"></i>
            Sélectionnez une table disponible (en vert) pour continuer
        </small>
    </div>
    {{else}}
    <div class="alert alert-warning text-center">
        <i class="bi bi-exclamation-triangle me-2"></i>
        Aucune table disponible pour ce créneau
    </div>
    {{/if}}
</script>

<!-- Template pour récapitulatif de réservation -->
<script id="reservation-summary-template" type="text/x-handlebars-template">
    <div class="card border-success">
        <div class="card-header bg-success text-white">
            <h6 class="mb-0">
                <i class="bi bi-check-circle me-2"></i>Réservation confirmée
            </h6>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-12">
                    <h6 class="text-success">Réservation #{{reservationId}}</h6>
                </div>
                <div class="col-md-6">
                    <small class="text-muted">Restaurant</small>
                    <div class="fw-bold">{{restaurantName}}</div>
                </div>
                <div class="col-md-6">
                    <small class="text-muted">Date</small>
                    <div class="fw-bold">{{dateReservation}}</div>
                </div>
                <div class="col-md-6">
                    <small class="text-muted">Créneau</small>
                    <div class="fw-bold">{{creneau.libelle}} ({{creneau.heureDebut}}-{{creneau.heureFin}})</div>
                </div>
                <div class="col-md-6">
                    <small class="text-muted">Table</small>
                    <div class="fw-bold">Table {{table.numeroTable}} ({{table.nbPlaces}} places)</div>
                </div>
                <div class="col-md-6">
                    <small class="text-muted">Client</small>
                    <div class="fw-bold">{{prenomClient}} {{nomClient}}</div>
                </div>
                <div class="col-md-6">
                    <small class="text-muted">Convives</small>
                    <div class="fw-bold">{{nbConvives}} personne(s)</div>
                </div>
            </div>
            <div class="mt-3 pt-3 border-top">
                <small class="text-muted">
                    <i class="bi bi-info-circle me-1"></i>
                    Votre table vous attendra à partir de {{creneau.heureDebut}}.
                    Merci de vous présenter à l'heure pour profiter pleinement de votre créneau.
                </small>
            </div>
        </div>
    </div>
</script>

<!-- Template pour les messages d'état de réservation -->
<script id="reservation-status-template" type="text/x-handlebars-template">
    <div class="alert alert-{{type}} d-flex align-items-center" role="alert">
        <i class="bi {{icon}} me-2"></i>
        <div>
            <strong>{{title}}</strong>
            {{#if message}}
            <div class="mt-1">{{message}}</div>
            {{/if}}
            {{#if details}}
            <div class="mt-2">
                <small>
                    {{#each details}}
                    <div>• {{this}}</div>
                    {{/each}}
                </small>
            </div>
            {{/if}}
        </div>
        {{#if showCloseButton}}
        <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
        {{/if}}
    </div>
</script>

<!-- ================================= -->
<!-- TEMPLATES VÉLIB -->
<!-- ================================= -->

<!-- Template Popup Vélib -->
<script id="velib-popup-template" type="text/x-handlebars-template">
    <div class="p-2">
        <h6 class="fw-bold mb-2">{{nom}}</h6>
        <div class="mb-3">
            <span class="badge {{#if estOuverte}}bg-success{{else}}bg-danger{{/if}}">
                <i class="bi {{#if estOuverte}}bi-check-circle{{else}}bi-x-circle{{/if}} me-1"></i>
                {{#if estOuverte}}Ouverte{{else}}Fermée{{/if}}
            </span>
        </div>
        {{#if estOuverte}}
        <div class="row g-2">
            <div class="col-6">
                <div class="card bg-primary bg-opacity-10">
                    <div class="card-body p-2 text-center">
                        <i class="bi bi-bicycle text-primary fs-4"></i>
                        <div class="fw-bold">{{velosDisponibles}}</div>
                        <small class="text-muted">vélos</small>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="card bg-success bg-opacity-10">
                    <div class="card-body p-2 text-center">
                        <i class="bi bi-p-square text-success fs-4"></i>
                        <div class="fw-bold">{{placesDisponibles}}</div>
                        <small class="text-muted">places</small>
                    </div>
                </div>
            </div>
        </div>
        {{/if}}
    </div>
</script>

<!-- ================================= -->
<!-- TEMPLATES INCIDENTS -->
<!-- ================================= -->

<!-- Template Popup Incident -->
<script id="incident-popup-template" type="text/x-handlebars-template">
    <div class="p-2">
        <h6 class="fw-bold mb-2">{{titre}}</h6>
        <div class="mb-2">
            <span class="badge bg-warning me-1">{{typeLabel}}</span>
            <span class="badge {{#if (eq impact 'faible')}}bg-success{{/if}}{{#if (eq impact 'moyen')}}bg-warning{{/if}}{{#if (eq impact 'fort')}}bg-danger{{/if}}">
                Impact {{impact}}
            </span>
        </div>
        <p class="small mb-2">{{description}}</p>
        <div class="small text-muted">
            <i class="bi bi-clock me-1"></i>Du {{dateDebut}} au {{dateFin}}
        </div>
    </div>
</script>

<!-- ================================= -->
<!-- TEMPLATES UTILITAIRES -->
<!-- ================================= -->

<!-- Template pour les statistiques -->
<script id="stats-template" type="text/x-handlebars-template">
    <div class="d-flex gap-3 small">
        <span><i class="bi bi-shop text-primary"></i> {{restaurantsCount}}</span>
        <span><i class="bi bi-bicycle text-success"></i> {{velibCount}}</span>
        <span><i class="bi bi-exclamation-triangle text-warning"></i> {{incidentsCount}}</span>
    </div>
</script>

<!-- ================================= -->
<!-- TEMPLATES COMPTE-RENDU -->
<!-- ================================= -->

<!-- Template Compte-rendu -->
<script id="compte-rendu-template" type="text/x-handlebars-template">
    <div class="container my-4">
        <div class="text-center mb-5">
            <h2 class="text-primary">Compte-rendu du Projet</h2>
            <p class="text-muted">Application Répartie - Nancy Spot</p>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h3 class="card-title mb-0"><i class="bi bi-diagram-3 me-2"></i>Architecture</h3>
            </div>
            <div class="card-body">
                <p>Architecture multi-tiers avec Frontend modulaire :</p>
                <ul>
                    <li><strong>Frontend :</strong> JavaScript ES6 modules + Bootstrap + Handlebars</li>
                    <li><strong>Service Central :</strong> HTTP/HTTPS + RMI Registry</li>
                    <li><strong>Service BD :</strong> Oracle + RMI</li>
                    <li><strong>Service Proxy :</strong> APIs externes + RMI</li>
                </ul>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3 class="card-title mb-0"><i class="bi bi-code-slash me-2"></i>Fonctionnalités</h3>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-primary bg-opacity-10 rounded-circle p-3 me-3">
                                <i class="bi bi-shop text-primary fs-4"></i>
                            </div>
                            <div>
                                <h6>Restaurants</h6>
                                <p class="small text-muted mb-0">Réservation en temps réel avec créneaux horaires</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-success bg-opacity-10 rounded-circle p-3 me-3">
                                <i class="bi bi-bicycle text-success fs-4"></i>
                            </div>
                            <div>
                                <h6>Vélib</h6>
                                <p class="small text-muted mb-0">Disponibilité en direct via API externe</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-warning bg-opacity-10 rounded-circle p-3 me-3">
                                <i class="bi bi-exclamation-triangle text-warning fs-4"></i>
                            </div>
                            <div>
                                <h6>Incidents</h6>
                                <p class="small text-muted mb-0">Trafic et travaux en temps réel</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<!-- Template Compte-rendu avec statistiques -->
<script id="compte-rendu-enrichi-template" type="text/x-handlebars-template">
    <div class="container my-4">
        <div class="text-center mb-5">
            <h2 class="text-primary">Compte-rendu du Projet</h2>
            <p class="text-muted">Application Répartie - Nancy Spot avec Créneaux Horaires</p>
        </div>

        <!-- Statistiques -->
        {{#if stats}}
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-shop fs-1 text-primary"></i>
                        <h3 class="mt-2">{{stats.restaurants}}</h3>
                        <p class="text-muted">Restaurants</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-bicycle fs-1 text-success"></i>
                        <h3 class="mt-2">{{stats.velib}}</h3>
                        <p class="text-muted">Stations Vélib</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-exclamation-triangle fs-1 text-warning"></i>
                        <h3 class="mt-2">{{stats.incidents}}</h3>
                        <p class="text-muted">Incidents</p>
                    </div>
                </div>
            </div>
        </div>
        {{/if}}

        <!-- Nouvelles fonctionnalités -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h3 class="card-title mb-0"><i class="bi bi-star me-2"></i>Nouvelles Fonctionnalités v2.0</h3>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="d-flex align-items-start">
                            <div class="bg-primary bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="bi bi-clock text-primary fs-5"></i>
                            </div>
                            <div>
                                <h6 class="text-primary">Créneaux Horaires</h6>
                                <p class="small mb-0">Réservation par créneaux : Déjeuner, Dîner, Brunch</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-start">
                            <div class="bg-success bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="bi bi-calendar-check text-success fs-5"></i>
                            </div>
                            <div>
                                <h6 class="text-success">Workflow de Réservation</h6>
                                <p class="small mb-0">Processus en 3 étapes : Date → Créneau → Table</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-start">
                            <div class="bg-warning bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="bi bi-shield-check text-warning fs-5"></i>
                            </div>
                            <div>
                                <h6 class="text-warning">Gestion des Conflits</h6>
                                <p class="small mb-0">Validation transactionnelle et prévention des doublons</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-start">
                            <div class="bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="bi bi-graph-up text-info fs-5"></i>
                            </div>
                            <div>
                                <h6 class="text-info">Statut Temps Réel</h6>
                                <p class="small mb-0">Disponibilité des tables par créneau en temps réel</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Architecture -->
        <div class="card mb-4">
            <div class="card-header">
                <h3 class="card-title mb-0"><i class="bi bi-diagram-3 me-2"></i>Architecture</h3>
            </div>
            <div class="card-body">
                <p>Architecture multi-tiers améliorée avec support des créneaux :</p>
                <ul>
                    <li><strong>Frontend :</strong> JavaScript ES6 modules + Bootstrap + Handlebars + Templates créneaux</li>
                    <li><strong>Service Central :</strong> HTTP/HTTPS + RMI Registry + 12 nouveaux endpoints</li>
                    <li><strong>Service BD :</strong> Oracle + RMI + Gestion transactionnelle des créneaux</li>
                    <li><strong>Service Proxy :</strong> APIs externes + RMI (Vélib, Incidents)</li>
                </ul>
            </div>
        </div>

        <!-- Fonctionnalités -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mb-0"><i class="bi bi-code-slash me-2"></i>Fonctionnalités Détaillées</h3>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-primary bg-opacity-10 rounded-circle p-3 me-3">
                                <i class="bi bi-shop text-primary fs-4"></i>
                            </div>
                            <div>
                                <h6>Restaurants</h6>
                                <p class="small text-muted mb-0">
                                    • Réservation par créneaux horaires<br>
                                    • Gestion des conflits automatique<br>
                                    • Interface de sélection visuelle
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-success bg-opacity-10 rounded-circle p-3 me-3">
                                <i class="bi bi-bicycle text-success fs-4"></i>
                            </div>
                            <div>
                                <h6>Vélib</h6>
                                <p class="small text-muted mb-0">
                                    • API GBFS Cyclocity en direct<br>
                                    • Statut temps réel des stations<br>
                                    • Disponibilité vélos/places
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-warning bg-opacity-10 rounded-circle p-3 me-3">
                                <i class="bi bi-exclamation-triangle text-warning fs-4"></i>
                            </div>
                            <div>
                                <h6>Incidents</h6>
                                <p class="small text-muted mb-0">
                                    • Données Grand Nancy en temps réel<br>
                                    • Classification par impact<br>
                                    • Localisation précise
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<!-- Bootstrap JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Leaflet JavaScript -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Handlebars JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.8/handlebars.min.js"></script>

<!-- Application principale -->
<script type="module" src="js/app.js"></script>

</body>
</html>